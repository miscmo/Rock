<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sylar: sylar/tcp_server.h 源文件</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">sylar
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_85140288eee94f6c1dbd59c496fa876b.html">sylar</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">tcp_server.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="tcp__server_8h.html">浏览该文件的文档.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#ifndef __SYLAR_TCP_SERVER_H__</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#define __SYLAR_TCP_SERVER_H__</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="address_8h.html">address.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="iomanager_8h.html">iomanager.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="socket_8h.html">socket.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="noncopyable_8h.html">noncopyable.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="config_8h.html">config.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">namespace </span>sylar {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="structsylar_1_1TcpServerConf.html">   22</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structsylar_1_1TcpServerConf.html">TcpServerConf</a> {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keyword">typedef</span> std::shared_ptr&lt;TcpServerConf&gt; ptr;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    std::vector&lt;std::string&gt; address;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordtype">int</span> keepalive = 0;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordtype">int</span> timeout = 1000 * 2 * 60;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">int</span> ssl = 0;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    std::string id;</div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="structsylar_1_1TcpServerConf.html#a4020af7912328173b72e0658734f3bb2">   31</a></span>&#160;    std::string <a class="code" href="structsylar_1_1TcpServerConf.html#a4020af7912328173b72e0658734f3bb2">type</a> = <span class="stringliteral">&quot;http&quot;</span>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    std::string name;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    std::string cert_file;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    std::string key_file;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    std::string accept_worker;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    std::string io_worker;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    std::string process_worker;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    std::map&lt;std::string, std::string&gt; args;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordtype">bool</span> isValid()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">return</span> !address.empty();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">bool</span> operator==(<span class="keyword">const</span> <a class="code" href="structsylar_1_1TcpServerConf.html">TcpServerConf</a>&amp; oth)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">return</span> address == oth.address</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            &amp;&amp; keepalive == oth.keepalive</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            &amp;&amp; timeout == oth.timeout</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            &amp;&amp; name == oth.name</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            &amp;&amp; ssl == oth.ssl</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            &amp;&amp; cert_file == oth.cert_file</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            &amp;&amp; key_file == oth.key_file</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            &amp;&amp; accept_worker == oth.accept_worker</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            &amp;&amp; io_worker == oth.io_worker</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            &amp;&amp; process_worker == oth.process_worker</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            &amp;&amp; args == oth.args</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            &amp;&amp; <span class="keywordtype">id</span> == oth.id</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            &amp;&amp; <a class="code" href="structsylar_1_1TcpServerConf.html#a4020af7912328173b72e0658734f3bb2">type</a> == oth.<a class="code" href="structsylar_1_1TcpServerConf.html#a4020af7912328173b72e0658734f3bb2">type</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;};</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="classsylar_1_1LexicalCast_3_01std_1_1string_00_01TcpServerConf_01_4.html">   62</a></span>&#160;<span class="keyword">class </span><a class="code" href="classsylar_1_1LexicalCast.html">LexicalCast</a>&lt;std::string, <a class="code" href="structsylar_1_1TcpServerConf.html">TcpServerConf</a>&gt; {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="structsylar_1_1TcpServerConf.html">TcpServerConf</a> <a class="code" href="classsylar_1_1LexicalCast.html#a2f757be55b2ef3342f407845ba4cbd40">operator()</a>(<span class="keyword">const</span> std::string&amp; v) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        YAML::Node node = YAML::Load(v);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="structsylar_1_1TcpServerConf.html">TcpServerConf</a> conf;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        conf.id = node[<span class="stringliteral">&quot;id&quot;</span>].as&lt;std::string&gt;(conf.id);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        conf.<a class="code" href="structsylar_1_1TcpServerConf.html#a4020af7912328173b72e0658734f3bb2">type</a> = node[<span class="stringliteral">&quot;type&quot;</span>].as&lt;std::string&gt;(conf.<a class="code" href="structsylar_1_1TcpServerConf.html#a4020af7912328173b72e0658734f3bb2">type</a>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        conf.keepalive = node[<span class="stringliteral">&quot;keepalive&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;(conf.keepalive);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        conf.timeout = node[<span class="stringliteral">&quot;timeout&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;(conf.timeout);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        conf.name = node[<span class="stringliteral">&quot;name&quot;</span>].as&lt;std::string&gt;(conf.name);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        conf.ssl = node[<span class="stringliteral">&quot;ssl&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;(conf.ssl);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        conf.cert_file = node[<span class="stringliteral">&quot;cert_file&quot;</span>].as&lt;std::string&gt;(conf.cert_file);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        conf.key_file = node[<span class="stringliteral">&quot;key_file&quot;</span>].as&lt;std::string&gt;(conf.key_file);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        conf.accept_worker = node[<span class="stringliteral">&quot;accept_worker&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        conf.io_worker = node[<span class="stringliteral">&quot;io_worker&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        conf.process_worker = node[<span class="stringliteral">&quot;process_worker&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        conf.args = <a class="code" href="classsylar_1_1LexicalCast.html">LexicalCast</a>&lt;std::string</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            ,std::map&lt;std::string, std::string&gt; &gt;()(node[<span class="stringliteral">&quot;args&quot;</span>].as&lt;std::string&gt;(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">if</span>(node[<span class="stringliteral">&quot;address&quot;</span>].IsDefined()) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; node[<span class="stringliteral">&quot;address&quot;</span>].size(); ++i) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                conf.address.push_back(node[<span class="stringliteral">&quot;address&quot;</span>][i].as&lt;std::string&gt;());</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">return</span> conf;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;};</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="classsylar_1_1LexicalCast_3_01TcpServerConf_00_01std_1_1string_01_4.html">   90</a></span>&#160;<span class="keyword">class </span><a class="code" href="classsylar_1_1LexicalCast.html">LexicalCast</a>&lt;<a class="code" href="structsylar_1_1TcpServerConf.html">TcpServerConf</a>, std::string&gt; {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    std::string <a class="code" href="classsylar_1_1LexicalCast.html#a2f757be55b2ef3342f407845ba4cbd40">operator()</a>(<span class="keyword">const</span> <a class="code" href="structsylar_1_1TcpServerConf.html">TcpServerConf</a>&amp; conf) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        YAML::Node node;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        node[<span class="stringliteral">&quot;id&quot;</span>] = conf.id;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        node[<span class="stringliteral">&quot;type&quot;</span>] = conf.<a class="code" href="structsylar_1_1TcpServerConf.html#a4020af7912328173b72e0658734f3bb2">type</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        node[<span class="stringliteral">&quot;name&quot;</span>] = conf.name;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        node[<span class="stringliteral">&quot;keepalive&quot;</span>] = conf.keepalive;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        node[<span class="stringliteral">&quot;timeout&quot;</span>] = conf.timeout;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        node[<span class="stringliteral">&quot;ssl&quot;</span>] = conf.ssl;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        node[<span class="stringliteral">&quot;cert_file&quot;</span>] = conf.cert_file;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        node[<span class="stringliteral">&quot;key_file&quot;</span>] = conf.key_file;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        node[<span class="stringliteral">&quot;accept_worker&quot;</span>] = conf.accept_worker;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        node[<span class="stringliteral">&quot;io_worker&quot;</span>] = conf.io_worker;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        node[<span class="stringliteral">&quot;process_worker&quot;</span>] = conf.process_worker;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        node[<span class="stringliteral">&quot;args&quot;</span>] = YAML::Load(<a class="code" href="classsylar_1_1LexicalCast.html">LexicalCast</a>&lt;std::map&lt;std::string, std::string&gt;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            , std::string&gt;()(conf.args));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; i : conf.address) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            node[<span class="stringliteral">&quot;address&quot;</span>].push_back(i);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        ss &lt;&lt; node;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">return</span> ss.str();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;};</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="classsylar_1_1TcpServer.html">  119</a></span>&#160;<span class="keyword">class </span><a class="code" href="classsylar_1_1TcpServer.html">TcpServer</a> : <span class="keyword">public</span> std::enable_shared_from_this&lt;TcpServer&gt;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    , <a class="code" href="classsylar_1_1Noncopyable.html">Noncopyable</a> {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keyword">typedef</span> std::shared_ptr&lt;TcpServer&gt; ptr;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="classsylar_1_1TcpServer.html#a0c7f9e2e803b9d1570a97c754f66ec4b">TcpServer</a>(<a class="code" href="classsylar_1_1IOManager.html">sylar::IOManager</a>* worker = <a class="code" href="classsylar_1_1IOManager.html#a84320322b91d83534bbcc34086d4468c">sylar::IOManager::GetThis</a>()</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;              ,<a class="code" href="classsylar_1_1IOManager.html">sylar::IOManager</a>* io_woker = <a class="code" href="classsylar_1_1IOManager.html#a84320322b91d83534bbcc34086d4468c">sylar::IOManager::GetThis</a>()</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;              ,<a class="code" href="classsylar_1_1IOManager.html">sylar::IOManager</a>* accept_worker = <a class="code" href="classsylar_1_1IOManager.html#a84320322b91d83534bbcc34086d4468c">sylar::IOManager::GetThis</a>());</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classsylar_1_1TcpServer.html#a883425ffb2aa3fa7f841640d710c44f0">~TcpServer</a>();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classsylar_1_1TcpServer.html#a5949bf7f7d58aa0a3ca1e6a0c1e633c3">bind</a>(sylar::Address::ptr addr, <span class="keywordtype">bool</span> ssl = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classsylar_1_1TcpServer.html#a5949bf7f7d58aa0a3ca1e6a0c1e633c3">bind</a>(<span class="keyword">const</span> std::vector&lt;Address::ptr&gt;&amp; addrs</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                        ,std::vector&lt;Address::ptr&gt;&amp; fails</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                        ,<span class="keywordtype">bool</span> ssl = <span class="keyword">false</span>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">bool</span> loadCertificates(<span class="keyword">const</span> std::string&amp; cert_file, <span class="keyword">const</span> std::string&amp; key_file);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classsylar_1_1TcpServer.html#a20bde67a5274ff1db29890866ed54cc1">start</a>();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classsylar_1_1TcpServer.html#ae77ccab6e1481baaca597b1d1b93b2cc">stop</a>();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="classsylar_1_1TcpServer.html#af517f20bb50cb3dc02d5220cb16059fb">  170</a></span>&#160;    uint64_t <a class="code" href="classsylar_1_1TcpServer.html#af517f20bb50cb3dc02d5220cb16059fb">getRecvTimeout</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classsylar_1_1TcpServer.html#a66e920154ce8bd4865669555f91b45bb">m_recvTimeout</a>;}</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="classsylar_1_1TcpServer.html#afa18d9f9fffad707061d4bf96451f2a1">  175</a></span>&#160;    std::string <a class="code" href="classsylar_1_1TcpServer.html#afa18d9f9fffad707061d4bf96451f2a1">getName</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classsylar_1_1TcpServer.html#a9c956ff52912062eeb6fe53f8a712e55">m_name</a>;}</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="classsylar_1_1TcpServer.html#adf506161f3352fa94e244aa26fd9e56f">  180</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classsylar_1_1TcpServer.html#adf506161f3352fa94e244aa26fd9e56f">setRecvTimeout</a>(uint64_t v) { <a class="code" href="classsylar_1_1TcpServer.html#a66e920154ce8bd4865669555f91b45bb">m_recvTimeout</a> = v;}</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="classsylar_1_1TcpServer.html#aeebc37c4c913dbab784c7d25a2115992">  185</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classsylar_1_1TcpServer.html#aeebc37c4c913dbab784c7d25a2115992">setName</a>(<span class="keyword">const</span> std::string&amp; v) { <a class="code" href="classsylar_1_1TcpServer.html#a9c956ff52912062eeb6fe53f8a712e55">m_name</a> = v;}</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="classsylar_1_1TcpServer.html#adc2f7cc515ca4a624d29599dd924cf41">  190</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classsylar_1_1TcpServer.html#adc2f7cc515ca4a624d29599dd924cf41">isStop</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classsylar_1_1TcpServer.html#ad56141ae810906378dd8fc3fc98b0bfd">m_isStop</a>;}</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    TcpServerConf::ptr getConf()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_conf;}</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">void</span> setConf(TcpServerConf::ptr v) { m_conf = v;}</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">void</span> setConf(<span class="keyword">const</span> TcpServerConf&amp; v);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keyword">virtual</span> std::string toString(<span class="keyword">const</span> std::string&amp; prefix = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    std::vector&lt;Socket::ptr&gt; getSocks()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classsylar_1_1TcpServer.html#a9a7e9678dc10633c3e14052f01df31dc">m_socks</a>;}</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classsylar_1_1TcpServer.html#ac952ea5e6b1ca2422b9bf847fcf5f438">handleClient</a>(Socket::ptr client);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classsylar_1_1TcpServer.html#a0e0c75ce5b544ef54328033620f2a54b">startAccept</a>(Socket::ptr sock);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="classsylar_1_1TcpServer.html#a9a7e9678dc10633c3e14052f01df31dc">  212</a></span>&#160;    std::vector&lt;Socket::ptr&gt; <a class="code" href="classsylar_1_1TcpServer.html#a9a7e9678dc10633c3e14052f01df31dc">m_socks</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="classsylar_1_1TcpServer.html#a7cbfab7ee6e57fe94944f3767662c7e3">  214</a></span>&#160;    <a class="code" href="classsylar_1_1IOManager.html">IOManager</a>* <a class="code" href="classsylar_1_1TcpServer.html#a7cbfab7ee6e57fe94944f3767662c7e3">m_worker</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="classsylar_1_1IOManager.html">IOManager</a>* m_ioWorker;</div>
<div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="classsylar_1_1TcpServer.html#a422a2b28ab2534ae1a70c3e553d01172">  217</a></span>&#160;    <a class="code" href="classsylar_1_1IOManager.html">IOManager</a>* <a class="code" href="classsylar_1_1TcpServer.html#a422a2b28ab2534ae1a70c3e553d01172">m_acceptWorker</a>;</div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="classsylar_1_1TcpServer.html#a66e920154ce8bd4865669555f91b45bb">  219</a></span>&#160;    uint64_t <a class="code" href="classsylar_1_1TcpServer.html#a66e920154ce8bd4865669555f91b45bb">m_recvTimeout</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="classsylar_1_1TcpServer.html#a9c956ff52912062eeb6fe53f8a712e55">  221</a></span>&#160;    std::string <a class="code" href="classsylar_1_1TcpServer.html#a9c956ff52912062eeb6fe53f8a712e55">m_name</a>;</div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="classsylar_1_1TcpServer.html#a393335266c777ba4fc4c7299c5e7499a">  223</a></span>&#160;    std::string <a class="code" href="classsylar_1_1TcpServer.html#a393335266c777ba4fc4c7299c5e7499a">m_type</a> = <span class="stringliteral">&quot;tcp&quot;</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="classsylar_1_1TcpServer.html#ad56141ae810906378dd8fc3fc98b0bfd">  225</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classsylar_1_1TcpServer.html#ad56141ae810906378dd8fc3fc98b0bfd">m_isStop</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">bool</span> m_ssl = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    TcpServerConf::ptr m_conf;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;};</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclasssylar_1_1TcpServer_html_adf506161f3352fa94e244aa26fd9e56f"><div class="ttname"><a href="classsylar_1_1TcpServer.html#adf506161f3352fa94e244aa26fd9e56f">sylar::TcpServer::setRecvTimeout</a></div><div class="ttdeci">void setRecvTimeout(uint64_t v)</div><div class="ttdoc">设置读取超时时间(毫秒)</div><div class="ttdef"><b>Definition:</b> tcp_server.h:180</div></div>
<div class="ttc" id="aclasssylar_1_1IOManager_html"><div class="ttname"><a href="classsylar_1_1IOManager.html">sylar::IOManager</a></div><div class="ttdoc">基于Epoll的IO协程调度器</div><div class="ttdef"><b>Definition:</b> iomanager.h:20</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_a0e0c75ce5b544ef54328033620f2a54b"><div class="ttname"><a href="classsylar_1_1TcpServer.html#a0e0c75ce5b544ef54328033620f2a54b">sylar::TcpServer::startAccept</a></div><div class="ttdeci">virtual void startAccept(Socket::ptr sock)</div><div class="ttdoc">开始接受连接</div></div>
<div class="ttc" id="aclasssylar_1_1LexicalCast_html"><div class="ttname"><a href="classsylar_1_1LexicalCast.html">sylar::LexicalCast</a></div><div class="ttdoc">类型转换模板类(F 源类型, T 目标类型)</div><div class="ttdef"><b>Definition:</b> config.h:88</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_a9c956ff52912062eeb6fe53f8a712e55"><div class="ttname"><a href="classsylar_1_1TcpServer.html#a9c956ff52912062eeb6fe53f8a712e55">sylar::TcpServer::m_name</a></div><div class="ttdeci">std::string m_name</div><div class="ttdoc">服务器名称</div><div class="ttdef"><b>Definition:</b> tcp_server.h:221</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_ad56141ae810906378dd8fc3fc98b0bfd"><div class="ttname"><a href="classsylar_1_1TcpServer.html#ad56141ae810906378dd8fc3fc98b0bfd">sylar::TcpServer::m_isStop</a></div><div class="ttdeci">bool m_isStop</div><div class="ttdoc">服务是否停止</div><div class="ttdef"><b>Definition:</b> tcp_server.h:225</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_a883425ffb2aa3fa7f841640d710c44f0"><div class="ttname"><a href="classsylar_1_1TcpServer.html#a883425ffb2aa3fa7f841640d710c44f0">sylar::TcpServer::~TcpServer</a></div><div class="ttdeci">virtual ~TcpServer()</div><div class="ttdoc">析构函数</div></div>
<div class="ttc" id="aclasssylar_1_1IOManager_html_a84320322b91d83534bbcc34086d4468c"><div class="ttname"><a href="classsylar_1_1IOManager.html#a84320322b91d83534bbcc34086d4468c">sylar::IOManager::GetThis</a></div><div class="ttdeci">static IOManager * GetThis()</div><div class="ttdoc">返回当前的IOManager</div></div>
<div class="ttc" id="aclasssylar_1_1LexicalCast_html_a2f757be55b2ef3342f407845ba4cbd40"><div class="ttname"><a href="classsylar_1_1LexicalCast.html#a2f757be55b2ef3342f407845ba4cbd40">sylar::LexicalCast::operator()</a></div><div class="ttdeci">T operator()(const F &amp;v)</div><div class="ttdoc">类型转换</div><div class="ttdef"><b>Definition:</b> config.h:96</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_ac952ea5e6b1ca2422b9bf847fcf5f438"><div class="ttname"><a href="classsylar_1_1TcpServer.html#ac952ea5e6b1ca2422b9bf847fcf5f438">sylar::TcpServer::handleClient</a></div><div class="ttdeci">virtual void handleClient(Socket::ptr client)</div><div class="ttdoc">处理新连接的Socket类</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_aeebc37c4c913dbab784c7d25a2115992"><div class="ttname"><a href="classsylar_1_1TcpServer.html#aeebc37c4c913dbab784c7d25a2115992">sylar::TcpServer::setName</a></div><div class="ttdeci">virtual void setName(const std::string &amp;v)</div><div class="ttdoc">设置服务器名称</div><div class="ttdef"><b>Definition:</b> tcp_server.h:185</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_a7cbfab7ee6e57fe94944f3767662c7e3"><div class="ttname"><a href="classsylar_1_1TcpServer.html#a7cbfab7ee6e57fe94944f3767662c7e3">sylar::TcpServer::m_worker</a></div><div class="ttdeci">IOManager * m_worker</div><div class="ttdoc">新连接的Socket工作的调度器</div><div class="ttdef"><b>Definition:</b> tcp_server.h:214</div></div>
<div class="ttc" id="aaddress_8h_html"><div class="ttname"><a href="address_8h.html">address.h</a></div><div class="ttdoc">网络地址的封装(IPv4,IPv6,Unix)</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_ae77ccab6e1481baaca597b1d1b93b2cc"><div class="ttname"><a href="classsylar_1_1TcpServer.html#ae77ccab6e1481baaca597b1d1b93b2cc">sylar::TcpServer::stop</a></div><div class="ttdeci">virtual void stop()</div><div class="ttdoc">停止服务</div></div>
<div class="ttc" id="astructsylar_1_1TcpServerConf_html"><div class="ttname"><a href="structsylar_1_1TcpServerConf.html">sylar::TcpServerConf</a></div><div class="ttdef"><b>Definition:</b> tcp_server.h:22</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_a66e920154ce8bd4865669555f91b45bb"><div class="ttname"><a href="classsylar_1_1TcpServer.html#a66e920154ce8bd4865669555f91b45bb">sylar::TcpServer::m_recvTimeout</a></div><div class="ttdeci">uint64_t m_recvTimeout</div><div class="ttdoc">接收超时时间(毫秒)</div><div class="ttdef"><b>Definition:</b> tcp_server.h:219</div></div>
<div class="ttc" id="aclasssylar_1_1Noncopyable_html"><div class="ttname"><a href="classsylar_1_1Noncopyable.html">sylar::Noncopyable</a></div><div class="ttdoc">对象无法拷贝,赋值</div><div class="ttdef"><b>Definition:</b> noncopyable.h:17</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html"><div class="ttname"><a href="classsylar_1_1TcpServer.html">sylar::TcpServer</a></div><div class="ttdoc">TCP服务器封装</div><div class="ttdef"><b>Definition:</b> tcp_server.h:119</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_a0c7f9e2e803b9d1570a97c754f66ec4b"><div class="ttname"><a href="classsylar_1_1TcpServer.html#a0c7f9e2e803b9d1570a97c754f66ec4b">sylar::TcpServer::TcpServer</a></div><div class="ttdeci">TcpServer(sylar::IOManager *worker=sylar::IOManager::GetThis(), sylar::IOManager *io_woker=sylar::IOManager::GetThis(), sylar::IOManager *accept_worker=sylar::IOManager::GetThis())</div><div class="ttdoc">构造函数</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_a5949bf7f7d58aa0a3ca1e6a0c1e633c3"><div class="ttname"><a href="classsylar_1_1TcpServer.html#a5949bf7f7d58aa0a3ca1e6a0c1e633c3">sylar::TcpServer::bind</a></div><div class="ttdeci">virtual bool bind(sylar::Address::ptr addr, bool ssl=false)</div><div class="ttdoc">绑定地址</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_a393335266c777ba4fc4c7299c5e7499a"><div class="ttname"><a href="classsylar_1_1TcpServer.html#a393335266c777ba4fc4c7299c5e7499a">sylar::TcpServer::m_type</a></div><div class="ttdeci">std::string m_type</div><div class="ttdoc">服务器类型</div><div class="ttdef"><b>Definition:</b> tcp_server.h:223</div></div>
<div class="ttc" id="anoncopyable_8h_html"><div class="ttname"><a href="noncopyable_8h.html">noncopyable.h</a></div><div class="ttdoc">不可拷贝对象封装</div></div>
<div class="ttc" id="aiomanager_8h_html"><div class="ttname"><a href="iomanager_8h.html">iomanager.h</a></div><div class="ttdoc">基于Epoll的IO协程调度器</div></div>
<div class="ttc" id="asocket_8h_html"><div class="ttname"><a href="socket_8h.html">socket.h</a></div><div class="ttdoc">Socket封装</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_afa18d9f9fffad707061d4bf96451f2a1"><div class="ttname"><a href="classsylar_1_1TcpServer.html#afa18d9f9fffad707061d4bf96451f2a1">sylar::TcpServer::getName</a></div><div class="ttdeci">std::string getName() const</div><div class="ttdoc">返回服务器名称</div><div class="ttdef"><b>Definition:</b> tcp_server.h:175</div></div>
<div class="ttc" id="aconfig_8h_html"><div class="ttname"><a href="config_8h.html">config.h</a></div><div class="ttdoc">配置模块</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_a422a2b28ab2534ae1a70c3e553d01172"><div class="ttname"><a href="classsylar_1_1TcpServer.html#a422a2b28ab2534ae1a70c3e553d01172">sylar::TcpServer::m_acceptWorker</a></div><div class="ttdeci">IOManager * m_acceptWorker</div><div class="ttdoc">服务器Socket接收连接的调度器</div><div class="ttdef"><b>Definition:</b> tcp_server.h:217</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_af517f20bb50cb3dc02d5220cb16059fb"><div class="ttname"><a href="classsylar_1_1TcpServer.html#af517f20bb50cb3dc02d5220cb16059fb">sylar::TcpServer::getRecvTimeout</a></div><div class="ttdeci">uint64_t getRecvTimeout() const</div><div class="ttdoc">返回读取超时时间(毫秒)</div><div class="ttdef"><b>Definition:</b> tcp_server.h:170</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_a20bde67a5274ff1db29890866ed54cc1"><div class="ttname"><a href="classsylar_1_1TcpServer.html#a20bde67a5274ff1db29890866ed54cc1">sylar::TcpServer::start</a></div><div class="ttdeci">virtual bool start()</div><div class="ttdoc">启动服务</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_adc2f7cc515ca4a624d29599dd924cf41"><div class="ttname"><a href="classsylar_1_1TcpServer.html#adc2f7cc515ca4a624d29599dd924cf41">sylar::TcpServer::isStop</a></div><div class="ttdeci">bool isStop() const</div><div class="ttdoc">是否停止</div><div class="ttdef"><b>Definition:</b> tcp_server.h:190</div></div>
<div class="ttc" id="astructsylar_1_1TcpServerConf_html_a4020af7912328173b72e0658734f3bb2"><div class="ttname"><a href="structsylar_1_1TcpServerConf.html#a4020af7912328173b72e0658734f3bb2">sylar::TcpServerConf::type</a></div><div class="ttdeci">std::string type</div><div class="ttdoc">服务器类型，http, ws, rock</div><div class="ttdef"><b>Definition:</b> tcp_server.h:31</div></div>
<div class="ttc" id="aclasssylar_1_1TcpServer_html_a9a7e9678dc10633c3e14052f01df31dc"><div class="ttname"><a href="classsylar_1_1TcpServer.html#a9a7e9678dc10633c3e14052f01df31dc">sylar::TcpServer::m_socks</a></div><div class="ttdeci">std::vector&lt; Socket::ptr &gt; m_socks</div><div class="ttdoc">监听Socket数组</div><div class="ttdef"><b>Definition:</b> tcp_server.h:212</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
制作者 &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
